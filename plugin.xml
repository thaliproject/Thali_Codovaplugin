<?xml version="1.0" encoding="UTF-8" ?>
<plugin xmlns="http://apache.org/cordova/ns/plugins/1.0" 
    xmlns:android="http://schemas.android.com/apk/res/android" 
    id="org.thaliproject.p2p" 
    version="0.0.1">
    <name>ThaliPlugin</name>
    <description>ThaliPlugin to be used on top of JXcore</description>
    <license>MIT</license>
    <keywords>cordova,jxcore,node.js,thali</keywords>
    <dependency id="io.jxcore.node" url="https://github.com/jxcore/jxcore-cordova" />
    
    <engines>
        <engine name="cordova-android" version=">=3.2.0" />
        <engine name="android-sdk" version=">=19" />
    </engines>

    <!-- Android -->
    <platform name="android">
        <config-file target="AndroidManifest.xml" parent="/*">
            <uses-permission android:name="android.permission.INTERNET" />
            <uses-permission android:name="android.permission.ACCESS_NETWORK_STATE" />
            <uses-permission android:name="android.permission.ACCESS_WIFI_STATE" />
            <uses-permission android:name="android.permission.WRITE_EXTERNAL_STORAGE" />
        </config-file>
        <framework src="src/android/JXcore.gradle" custom="true" type="gradleReference" />
        <source-file src="src/android/java/io/jxcore/node/BtToRequestSocket.java" target-dir="src/io/jxcore/node/" />
        <source-file src="src/android/java/io/jxcore/node/BtToServerSocket.java" target-dir="src/io/jxcore/node/" />
        <source-file src="src/android/java/io/jxcore/node/StreamCopyingThread.java" target-dir="src/io/jxcore/node/" />
        <source-file src="src/android/java/io/jxcore/node/BtConnectorHelper.java" target-dir="src/io/jxcore/node/" />
        <source-file src="src/android/java/io/jxcore/node/ConnectivityMonitor.java" target-dir="src/io/jxcore/node/" />
        <source-file src="src/android/java/io/jxcore/node/LifeCycleMonitor.java" target-dir="src/io/jxcore/node/" />
    </platform>

    <!-- iOS -->
    <platform name="ios">
        <config-file target="config.xml" parent="/*">
        </config-file>
        <framework src="MultipeerConnectivity.framework" />
        <framework src="CoreBluetooth.framework" />
        <framework src="SystemConfiguration.framework" />
        <source-file src="src/ios/JXcoreExtension.m" />
        <header-file src="src/ios/THEThreading.h" />
        <header-file src="src/ios/THEAtomicFlag.h" />
        <source-file src="src/ios/THEAtomicFlag.m" />
        <header-file src="src/ios/NPReachability/NPReachability.h" />
        <source-file src="src/ios/NPReachability/NPReachability.m" />
        <header-file src="src/ios/THEThaliCore.h" />
        <source-file src="src/ios/THEThaliCore.m" />
        <header-file src="src/ios/THEAppContext.h" />
        <source-file src="src/ios/THEAppContext.m" />
        <header-file src="src/ios/THEPeer.h" />
        <source-file src="src/ios/THEPeer.m" />
        <header-file src="src/ios/THEPeerBluetoothDelegate.h" />
        <header-file src="src/ios/THEPeerBluetooth.h" />
        <source-file src="src/ios/THEPeerBluetooth.m" />
        <header-file src="src/ios/THEPeerNetworkingDelegate.h" />
        <header-file src="src/ios/THEPeerNetworking.h" />
        <source-file src="src/ios/THEPeerNetworking.m" />
    </platform>
    <!-- Cordova hook for Thali pre-requisite -->
    <hook type="after_plugin_add" src="scripts/thaliPrerequisite.js" />

</plugin>